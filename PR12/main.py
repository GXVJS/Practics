"""
Практическая номер 12:
1. Вычисление выражения x^n / n!
2. Нахождение максимального числа в последовательности
"""

import sys

sys.setrecursionlimit(10000)  # Увеличиваем глубину рекурсии

# ЗАДАЧА 1: Вычисление выражения x^n / n!

def power_recursive(x, n):
    """
    Рекурсивное вычисление x в степени n
    """
    if n == 0:
        return 1
    elif n < 0:
        return 1 / power_recursive(x, -n)
    else:
        return x * power_recursive(x, n - 1)

def factorial_recursive(n):
    """
    Рекурсивное вычисление факториала n
    """
    if n == 0 or n == 1:
        return 1
    else:
        return n * factorial_recursive(n - 1)

def expression_recursive(x, n):
    """
    Рекурсивное вычисление выражения x^n / n!
    Использует оптимизированный подход: (x/n) * expression(x, n-1)
    """
    # Базовый случай: когда n = 0, x^0 / 0! = 1 / 1 = 1
    if n == 0:
        return 1.0

    # Рекурсивный случай: x^n / n! = (x / n) * (x^(n-1) / (n-1)!)
    return (x / n) * expression_recursive(x, n - 1)

# ЗАДАЧА 2: Нахождение максимального числа в последовательности

def find_max_recursive():
    """
    Рекурсивная функция для нахождения максимального значения в последовательности.
    Особенности:
    - Не использует глобальные переменные
    - Не принимает параметры
    - Считывает данные с клавиатуры
    - Возвращает единственное значение: максимум последовательности
    """
    try:
        # Считываем текущее число с клавиатуры
        num = int(input())
    except ValueError:
        print("Ошибка: введите целое число")
        return find_max_recursive()

    # Базовый случай: если число 0, возвращаем 0
    if num == 0:
        return 0

    # Рекурсивный случай: находим максимум в оставшейся последовательности
    next_max = find_max_recursive()

    # Возвращаем максимальное из текущего числа и максимума оставшейся части
    return num if num > next_max else next_max

# ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ И ДЕМОНСТРАЦИЯ

def demonstrate_task1():
    """Демонстрация работы задачи 1"""
    print("=" * 60)
    print("ЗАДАЧА 1: Вычисление выражения x^n / n!")
    print("=" * 60)

    print("Введите данные для вычисления x^n / n!")
    try:
        x = float(input("Введите число x: "))
        n = int(input("Введите натуральное число n: "))

        if n < 0:
            print("n должно быть натуральным числом (n >= 0)")
            return


        print("\nИспользуя оптимизированную рекурсивную функцию")
        result2 = expression_recursive(x, n)
        print(f"{x}^{n} / {n}! = {result2}")

    except ValueError:
        print("Ошибка ввода! Пожалуйста, введите числа корректно.")
    except RecursionError:
        print("Ошибка: слишком глубокая рекурсия! Попробуйте меньшее значение n.")


def demonstrate_task2():
    """Демонстрация работы задачи 2"""
    print("\n" + "=" * 60)
    print("ЗАДАЧА 2: Нахождение максимального числа в последовательности")
    print("=" * 60)

    print("Инструкция:")
    print("1. Вводите натуральные числа по одному в строке")
    print("2. Для завершения ввода введите 0")
    print("3. Гарантируется, что в последовательности есть хотя бы одно число кроме 0")
    print("\n" + "-" * 40)

    print("Начните ввод чисел:")
    max_value = find_max_recursive()

    print(f"\nНаибольшее значение в последовательности: {max_value}")

# ============================================================================
# ГЛАВНАЯ ФУНКЦИЯ
# ============================================================================

def main():
    """Основная функция программы"""
    print("=" * 60)
    print("Практическая номер 12")
    print("=" * 60)

    while True:
        print("\nМЕНЮ:")
        print("1. Вычислить выражение x^n / n!")
        print("2. Найти максимальное число в последовательности")
        print("3. Выход")

        choice = input("\nВыберите действие (1-3): ")

        if choice == '1':
            demonstrate_task1()
        elif choice == '2':
            demonstrate_task2()
        elif choice == '3':
            print("\nВыход из программы.")
            break
        else:
            print("Неверный выбор. Попробуйте снова.")

        input("\nНажмите Enter для продолжения...")

# ТОЧКА ВХОДА

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nПрограмма завершена пользователем.")
    except Exception as e:
        print(f"\nПроизошла ошибка: {e}")